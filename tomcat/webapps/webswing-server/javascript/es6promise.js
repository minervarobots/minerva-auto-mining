/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   2.0.0
 */

(function(){function e(e,t){C[x]=e,C[x+1]=t,x+=2,2===x&&k()}function t(e){return"function"==typeof e}function n(){return function(){process.nextTick(o)}}function r(){var e=0,t=new N(o),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function i(){var e=new MessageChannel;return e.port1.onmessage=o,function(){e.port2.postMessage(0)}}function s(){return function(){setTimeout(o,1)}}function o(){for(var e=0;e<x;e+=2)(0,C[e])(C[e+1]),C[e]=void 0,C[e+1]=void 0;x=0}function u(){}function a(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function f(t,n,r){e(function(e){var t=!1,i=a(r,n,function(r){t||(t=!0,n!==r?c(e,r):p(e,r))},function(n){t||(t=!0,d(e,n))});!t&&i&&(t=!0,d(e,i))},t)}function l(e,t){1===t.a?p(e,t.b):2===e.a?d(e,t.b):v(t,void 0,function(t){c(e,t)},function(t){d(e,t)})}function c(e,n){if(e===n)d(e,new TypeError("You cannot resolve a promise with itself"));else if("function"==typeof n||"object"==typeof n&&null!==n)if(n.constructor===e.constructor)l(e,n);else{var r;try{r=n.then}catch(i){L.error=i,r=L}r===L?d(e,L.error):void 0===r?p(e,n):t(r)?f(e,n,r):p(e,n)}else p(e,n)}function h(e){e.f&&e.f(e.b),m(e)}function p(t,n){void 0===t.a&&(t.b=n,t.a=1,0!==t.e.length&&e(m,t))}function d(t,n){void 0===t.a&&(t.a=2,t.b=n,e(h,t))}function v(t,n,r,i){var s=t.e,o=s.length;t.f=null,s[o]=n,s[o+1]=r,s[o+2]=i,0===o&&t.a&&e(m,t)}function m(e){var t=e.e,n=e.a;if(0!==t.length){for(var r,i,s=e.b,o=0;o<t.length;o+=3)r=t[o],i=t[o+n],r?y(n,r,i,s):i(s);e.e.length=0}}function g(){this.error=null}function y(e,n,r,i){var s=t(r),o,u,a,f;if(s){try{o=r(i)}catch(l){A.error=l,o=A}o===A?(f=!0,u=o.error,o=null):a=!0;if(n===o){d(n,new TypeError("A promises callback cannot return that same promise."));return}}else o=i,a=!0;void 0===n.a&&(s&&a?c(n,o):f?d(n,u):1===e?p(n,o):2===e&&d(n,o))}function b(e,t){try{t(function(t){c(e,t)},function(t){d(e,t)})}catch(n){d(e,n)}}function w(e,t,n,r){this.n=e,this.c=new e(u,r),this.i=n,this.o(t)?(this.m=t,this.d=this.length=t.length,this.l(),0===this.length?p(this.c,this.b):(this.length=this.length||0,this.k(),0===this.d&&p(this.c,this.b))):d(this.c,this.p())}function E(e){O++,this.b=this.a=void 0,this.e=[];if(u!==e){if(!t(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof E))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");b(this,e)}}var S=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},x=0,T="undefined"!=typeof window?window:{},N=T.MutationObserver||T.WebKitMutationObserver,T="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,C=Array(1e3),k;k="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?n():N?r():T?i():s();var L=new g,A=new g;w.prototype.o=function(e){return S(e)},w.prototype.p=function(){return Error("Array Methods must be provided an Array")},w.prototype.l=function(){this.b=Array(this.length)},w.prototype.k=function(){for(var e=this.length,t=this.c,n=this.m,r=0;void 0===t.a&&r<e;r++)this.j(n[r],r)},w.prototype.j=function(e,t){var n=this.n;"object"==typeof e&&null!==e?e.constructor===n&&void 0!==e.a?(e.f=null,this.g(e.a,t,e.b)):this.q(n.resolve(e),t):(this.d--,this.b[t]=this.h(e))},w.prototype.g=function(e,t,n){var r=this.c;void 0===r.a&&(this.d--,this.i&&2===e?d(r,n):this.b[t]=this.h(n)),0===this.d&&p(r,this.b)},w.prototype.h=function(e){return e},w.prototype.q=function(e,t){var n=this;v(e,void 0,function(e){n.g(1,t,e)},function(e){n.g(2,t,e)})};var O=0;E.all=function(e,t){return(new w(this,e,!0,t)).c},E.race=function(e,t){function n(e){c(i,e)}function r(e){d(i,e)}var i=new this(u,t);if(!S(e))return d(i,new TypeError("You must pass an array to race.")),i;for(var s=e.length,o=0;void 0===i.a&&o<s;o++)v(this.resolve(e[o]),void 0,n,r);return i},E.resolve=function(e,t){if(e&&"object"==typeof e&&e.constructor===this)return e;var n=new this(u,t);return c(n,e),n},E.reject=function(e,t){var n=new this(u,t);return d(n,e),n},E.prototype={constructor:E,then:function(t,n){var r=this.a;if(1===r&&!t||2===r&&!n)return this;var i=new this.constructor(u),s=this.b;if(r){var o=arguments[r-1];e(function(){y(r,i,o,s)})}else v(this,i,t,n);return i},"catch":function(e){return this.then(null,e)}};var M={Promise:E,polyfill:function(){var e;e="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self,"Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var n;return new e.Promise(function(e){n=e}),t(n)}()||(e.Promise=E)}};"function"==typeof webswingRequirejs.define&&webswingRequirejs.define.amd?webswingRequirejs.define([],function(){return M}):"undefined"!=typeof module&&module.exports?module.exports=M:"undefined"!=typeof this&&(this.ES6Promise=M)}).call(this);
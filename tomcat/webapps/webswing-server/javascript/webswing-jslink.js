webswingRequirejs.define([],function amdFactory(){return function JsLinkModule(){function process(jsRequest){var response;try{if(jsRequest.type==="eval"){var indirectEval=eval,result=indirectEval(jsRequest.evalString);response=buildResponse(result,jsRequest.correlationId)}else if(jsRequest.type==="call"){var ref=jsRequest.thisObjectId!=null?referenceCache[jsRequest.thisObjectId]:window,args=decodeParams(jsRequest),result=ref[jsRequest.evalString].apply(ref,args);response=buildResponse(result,jsRequest.correlationId)}else if(jsRequest.type==="setMember"||jsRequest.type==="setSlot"){var ref=jsRequest.thisObjectId!=null?referenceCache[jsRequest.thisObjectId]:window,args=decodeParams(jsRequest);ref[jsRequest.evalString]=args!=null?args[0]:null,response=buildResponse(null,jsRequest.correlationId)}else if(jsRequest.type==="getMember"||jsRequest.type==="getSlot"){var ref=jsRequest.thisObjectId!=null?referenceCache[jsRequest.thisObjectId]:window;response=buildResponse(ref[jsRequest.evalString],jsRequest.correlationId)}else if(jsRequest.type==="deleteMember"){var ref=jsRequest.thisObjectId!=null?referenceCache[jsRequest.thisObjectId]:window;delete ref[jsRequest.evalString],response=buildResponse(null,jsRequest.correlationId)}jsRequest.garbageIds!=null&&jsRequest.garbageIds.forEach(function(e){delete referenceCache[e]}),api.send(response)}catch(e){throw response=buildResponse(e,jsRequest.correlationId),api.send(response),e}}function buildResponse(e,t){var n={jsResponse:serializeObject(e)};return n.jsResponse.correlationId=t,n}function serializeObject(e){var t={};return e==null?t:Object.prototype.toString.call(e)==="[object Error]"?(t.error=e.toString(),t):(t.value={},typeof e=="number"||typeof e=="string"||typeof e=="boolean"?t.value.primitive=JSON.stringify(e):e instanceof JavaObjectRef?t.value.javaObject={id:e.id}:(e[idMemberName]==null&&(e[idMemberName]=GUID(),referenceCache[e[idMemberName]]=e),t.value.jsObject={id:e[idMemberName]}),t)}function decodeParams(e){var t=[],n=e.params;if(n!=null)for(var r=0;r<n.length;r++)t.push(decodeJsParam(n[r]));return t}function decodeJsParam(e){if(e.primitive!=null)return JSON.parse(e.primitive);if(e.jsObject!=null)return referenceCache[e.jsObject.id];if(e.javaObject!=null)return new JavaObjectRef(e.javaObject);if(e.array!=null){var t=[];for(var n=0;n<e.array.length;n++)t.push(decodeJsParam(e.array[n]));return t}return null}function GUID(){var e=function(){return Math.floor(Math.random()*65536).toString(16)};return e()+e()+e()}function JavaObjectRef(e){this.id=e.id;if(e.methods!=null)for(var t=0;t<e.methods.length;t++){var n=e.methods[t];this[n]=function(t){return function(){var n=arguments;return new Promise(function(r,i){var s=GUID(),o=[];for(var u=0;u<n.length;u++){var a=serializeObject(n[u]);o[u]=a!=null?a.value:null}var f={javaRequest:{correlationId:s,objectId:e.id,method:t,params:o}};api.awaitResponse(function(e){Object.prototype.toString.call(e)==="[object Error]"?i(e):e.error!=null?i(new Error(e.error)):e.value!=null&&r(decodeJsParam(e.value))},f,s,api.cfg.javaCallTimeout)})}}(n)}}var module=this,api;module.injects=api={cfg:"webswing.config",external:"external",send:"socket.send",awaitResponse:"socket.awaitResponse"},module.provides={process:process},module.ready=function(){referenceCache.instanceObject=api.external};var idMemberName="__webswing_jslink_id",referenceCache={}}});